2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : Checking for rethrow: count=2
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : Retry: count=2
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [592a6ae4] HTTP POST /songs
2022-11-20 17:37:42 [reactor-http-nio-6] DEBUG : [b9ed5373] Created a new pooled channel, now: 0 active connections, 0 inactive connections and 0 pending acquire requests.
2022-11-20 17:37:42 [reactor-http-nio-6] DEBUG : [b9ed5373] Initialized pipeline DefaultChannelPipeline{(reactor.left.httpCodec = io.netty.handler.codec.http.HttpClientCodec), (reactor.right.reactiveBridge = reactor.netty.channel.ChannelOperationsHandler)}
2022-11-20 17:37:42 [reactor-http-nio-6] DEBUG : [b9ed5373] Connecting to [localhost/127.0.0.1:8091].
2022-11-20 17:37:42 [reactor-http-nio-6] DEBUG : [b9ed5373] Connect attempt to [localhost/127.0.0.1:8091] failed.
io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:8091
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at java.base/sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:777)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:337)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:776)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : Checking for rethrow: count=3
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : Retry failed last attempt: count=3
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] ERROR : Sending post request to song service failed with '3' retry attempts
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : Commit list: {}
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-1 at position FetchPosition{offset=12, offsetEpoch=Optional[29], currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=29}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Built incremental fetch (sessionId=1477165816, epoch=3096) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-1), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-2, correlationId=3636) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=1477165816, sessionEpoch=3096, topics=[], forgottenTopicsData=[], rackId='')
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-3, correlationId=3639): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=570225658, responses=[])
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-1, correlationId=3640): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=421773985, responses=[])
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 570225658 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 421773985 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-2 at position FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=26}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-0 at position FetchPosition{offset=14, offsetEpoch=Optional[24], currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=28}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Built incremental fetch (sessionId=421773985, epoch=3101) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Built incremental fetch (sessionId=570225658, epoch=3100) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-0), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-2), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-1, correlationId=3641) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=421773985, sessionEpoch=3101, topics=[], forgottenTopicsData=[], rackId='')
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-3, correlationId=3640) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=570225658, sessionEpoch=3100, topics=[], forgottenTopicsData=[], rackId='')
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-2, correlationId=3636): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=1477165816, responses=[])
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 1477165816 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-1 at position FetchPosition{offset=12, offsetEpoch=Optional[29], currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=29}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Built incremental fetch (sessionId=1477165816, epoch=3097) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-1), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-2, correlationId=3637) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=1477165816, sessionEpoch=3097, topics=[], forgottenTopicsData=[], rackId='')
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-1, correlationId=3641): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=421773985, responses=[])
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-3, correlationId=3640): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=570225658, responses=[])
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 421773985 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 570225658 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-0 at position FetchPosition{offset=14, offsetEpoch=Optional[24], currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=28}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-2 at position FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=26}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Built incremental fetch (sessionId=421773985, epoch=3102) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Built incremental fetch (sessionId=570225658, epoch=3101) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-0), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-2), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-1, correlationId=3642) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=421773985, sessionEpoch=3102, topics=[], forgottenTopicsData=[], rackId='')
2022-11-20 17:37:42 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-3, correlationId=3641) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=570225658, sessionEpoch=3101, topics=[], forgottenTopicsData=[], rackId='')
