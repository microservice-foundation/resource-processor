2022-11-20 17:37:41 [reactor-http-nio-3] DEBUG : [de137732-1, L:/127.0.0.1:59195 - R:localhost/127.0.0.1:8090] Received last HTTP packet
2022-11-20 17:37:41 [reactor-http-nio-3] DEBUG : [de137732, L:/127.0.0.1:59195 - R:localhost/127.0.0.1:8090] onStateChange(GET{uri=/api/v1/resources/86, connection=PooledConnection{channel=[id: 0xde137732, L:/127.0.0.1:59195 - R:localhost/127.0.0.1:8090]}}, [response_completed])
2022-11-20 17:37:41 [reactor-http-nio-3] DEBUG : [de137732, L:/127.0.0.1:59195 - R:localhost/127.0.0.1:8090] Removed handler: ReadTimeoutHandler, pipeline: DefaultChannelPipeline{(reactor.left.httpCodec = io.netty.handler.codec.http.HttpClientCodec), (reactor.left.responseTimeoutHandler = io.netty.handler.timeout.ReadTimeoutHandler), (WriteTimeoutHandler = io.netty.handler.timeout.WriteTimeoutHandler), (reactor.right.reactiveBridge = reactor.netty.channel.ChannelOperationsHandler)}
2022-11-20 17:37:41 [reactor-http-nio-3] DEBUG : [de137732, L:/127.0.0.1:59195 - R:localhost/127.0.0.1:8090] Removed handler: WriteTimeoutHandler, pipeline: DefaultChannelPipeline{(reactor.left.httpCodec = io.netty.handler.codec.http.HttpClientCodec), (reactor.left.responseTimeoutHandler = io.netty.handler.timeout.ReadTimeoutHandler), (reactor.right.reactiveBridge = reactor.netty.channel.ChannelOperationsHandler)}
2022-11-20 17:37:41 [reactor-http-nio-3] DEBUG : [de137732, L:/127.0.0.1:59195 - R:localhost/127.0.0.1:8090] Removed handler: reactor.left.responseTimeoutHandler, pipeline: DefaultChannelPipeline{(reactor.left.httpCodec = io.netty.handler.codec.http.HttpClientCodec), (reactor.right.reactiveBridge = reactor.netty.channel.ChannelOperationsHandler)}
2022-11-20 17:37:41 [reactor-http-nio-3] DEBUG : [de137732, L:/127.0.0.1:59195 - R:localhost/127.0.0.1:8090] onStateChange(GET{uri=/api/v1/resources/86, connection=PooledConnection{channel=[id: 0xde137732, L:/127.0.0.1:59195 - R:localhost/127.0.0.1:8090]}}, [disconnecting])
2022-11-20 17:37:41 [reactor-http-nio-3] DEBUG : [de137732, L:/127.0.0.1:59195 - R:localhost/127.0.0.1:8090] Releasing channel
2022-11-20 17:37:41 [reactor-http-nio-3] DEBUG : [de137732, L:/127.0.0.1:59195 - R:localhost/127.0.0.1:8090] Channel cleaned, now: 0 active connections, 1 inactive connections and 0 pending acquire requests.
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : Retry: count=0
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [37e64d4e] HTTP POST /songs
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : Creating a new [http] client pool [PoolFactory{evictionInterval=PT0S, leasingStrategy=fifo, maxConnections=500, maxIdleTime=-1, maxLifeTime=-1, metricsEnabled=false, pendingAcquireMaxCount=1000, pendingAcquireTimeout=45000}] for [localhost:8091]
2022-11-20 17:37:41 [reactor-http-nio-4] DEBUG : [89df56a4] Created a new pooled channel, now: 0 active connections, 0 inactive connections and 0 pending acquire requests.
2022-11-20 17:37:41 [reactor-http-nio-4] DEBUG : [89df56a4] Initialized pipeline DefaultChannelPipeline{(reactor.left.httpCodec = io.netty.handler.codec.http.HttpClientCodec), (reactor.right.reactiveBridge = reactor.netty.channel.ChannelOperationsHandler)}
2022-11-20 17:37:41 [reactor-http-nio-4] DEBUG : [89df56a4] Connecting to [localhost/127.0.0.1:8091].
2022-11-20 17:37:41 [reactor-http-nio-4] DEBUG : [89df56a4] Connect attempt to [localhost/127.0.0.1:8091] failed.
io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:8091
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at java.base/sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:777)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:337)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:776)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-3, correlationId=3636): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=570225658, responses=[])
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-1, correlationId=3637): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=421773985, responses=[])
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 421773985 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 570225658 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-2 at position FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=26}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-0 at position FetchPosition{offset=14, offsetEpoch=Optional[24], currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=28}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Built incremental fetch (sessionId=570225658, epoch=3098) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Built incremental fetch (sessionId=421773985, epoch=3099) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-2), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-0), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-3, correlationId=3637) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=570225658, sessionEpoch=3098, topics=[], forgottenTopicsData=[], rackId='')
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-1, correlationId=3638) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=421773985, sessionEpoch=3099, topics=[], forgottenTopicsData=[], rackId='')
2022-11-20 17:37:41 [kafka-coordinator-heartbeat-thread | resource-processor] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending Heartbeat request with generation 69 and member id consumer-resource-processor-1-aca575ef-2581-4482-9917-98cba4eb9077 to coordinator 10.22.157.37:9092 (id: 2147483647 rack: null)
2022-11-20 17:37:41 [kafka-coordinator-heartbeat-thread | resource-processor] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending HEARTBEAT request with header RequestHeader(apiKey=HEARTBEAT, apiVersion=4, clientId=consumer-resource-processor-1, correlationId=3639) and timeout 30000 to node 2147483647: HeartbeatRequestData(groupId='resource-processor', generationId=69, memberId='consumer-resource-processor-1-aca575ef-2581-4482-9917-98cba4eb9077', groupInstanceId=null)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Received HEARTBEAT response from node 2147483647 for request with header RequestHeader(apiKey=HEARTBEAT, apiVersion=4, clientId=consumer-resource-processor-1, correlationId=3639): HeartbeatResponseData(throttleTimeMs=0, errorCode=0)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Received successful Heartbeat response
2022-11-20 17:37:41 [kafka-coordinator-heartbeat-thread | resource-processor] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Sending Heartbeat request with generation 69 and member id consumer-resource-processor-2-7c9919d7-7f58-4469-95bc-ecd46b860924 to coordinator 10.22.157.37:9092 (id: 2147483647 rack: null)
2022-11-20 17:37:41 [kafka-coordinator-heartbeat-thread | resource-processor] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Sending HEARTBEAT request with header RequestHeader(apiKey=HEARTBEAT, apiVersion=4, clientId=consumer-resource-processor-2, correlationId=3635) and timeout 30000 to node 2147483647: HeartbeatRequestData(groupId='resource-processor', generationId=69, memberId='consumer-resource-processor-2-7c9919d7-7f58-4469-95bc-ecd46b860924', groupInstanceId=null)
2022-11-20 17:37:41 [kafka-coordinator-heartbeat-thread | resource-processor] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending Heartbeat request with generation 69 and member id consumer-resource-processor-3-76c7d7e0-50b6-400d-a695-322c9ffb247c to coordinator 10.22.157.37:9092 (id: 2147483647 rack: null)
2022-11-20 17:37:41 [kafka-coordinator-heartbeat-thread | resource-processor] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending HEARTBEAT request with header RequestHeader(apiKey=HEARTBEAT, apiVersion=4, clientId=consumer-resource-processor-3, correlationId=3638) and timeout 30000 to node 2147483647: HeartbeatRequestData(groupId='resource-processor', generationId=69, memberId='consumer-resource-processor-3-76c7d7e0-50b6-400d-a695-322c9ffb247c', groupInstanceId=null)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Received HEARTBEAT response from node 2147483647 for request with header RequestHeader(apiKey=HEARTBEAT, apiVersion=4, clientId=consumer-resource-processor-3, correlationId=3638): HeartbeatResponseData(throttleTimeMs=0, errorCode=0)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Received successful Heartbeat response
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : Checking for rethrow: count=1
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : Retry: count=1
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [19e9cedb] HTTP POST /songs
2022-11-20 17:37:41 [reactor-http-nio-5] DEBUG : [dba19545] Created a new pooled channel, now: 0 active connections, 0 inactive connections and 0 pending acquire requests.
2022-11-20 17:37:41 [reactor-http-nio-5] DEBUG : [dba19545] Initialized pipeline DefaultChannelPipeline{(reactor.left.httpCodec = io.netty.handler.codec.http.HttpClientCodec), (reactor.right.reactiveBridge = reactor.netty.channel.ChannelOperationsHandler)}
2022-11-20 17:37:41 [reactor-http-nio-5] DEBUG : [dba19545] Connecting to [localhost/127.0.0.1:8091].
2022-11-20 17:37:41 [reactor-http-nio-5] DEBUG : [dba19545] Connect attempt to [localhost/127.0.0.1:8091] failed.
io.netty.channel.AbstractChannel$AnnotatedConnectException: Connection refused: localhost/127.0.0.1:8091
Caused by: java.net.ConnectException: Connection refused
	at java.base/sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at java.base/sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:777)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:337)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:334)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:776)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:829)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-1, correlationId=3638): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=421773985, responses=[])
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-3, correlationId=3637): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=570225658, responses=[])
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 421773985 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 570225658 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-2 at position FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=26}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-0 at position FetchPosition{offset=14, offsetEpoch=Optional[24], currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=28}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Built incremental fetch (sessionId=570225658, epoch=3099) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-2), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Built incremental fetch (sessionId=421773985, epoch=3100) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-3, correlationId=3639) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=570225658, sessionEpoch=3099, topics=[], forgottenTopicsData=[], rackId='')
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-0), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-1, correlationId=3640) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=421773985, sessionEpoch=3100, topics=[], forgottenTopicsData=[], rackId='')
2022-11-20 17:37:41 [kafka-coordinator-heartbeat-thread | resource-processor] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Received HEARTBEAT response from node 2147483647 for request with header RequestHeader(apiKey=HEARTBEAT, apiVersion=4, clientId=consumer-resource-processor-2, correlationId=3635): HeartbeatResponseData(throttleTimeMs=0, errorCode=0)
2022-11-20 17:37:41 [kafka-coordinator-heartbeat-thread | resource-processor] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Received successful Heartbeat response
