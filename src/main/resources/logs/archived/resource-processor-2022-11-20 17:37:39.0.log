2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-2, correlationId=3633): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=1477165816, responses=[FetchableTopicResponse(topic='', topicId=dIcm1yNOQS2tA7tmVPbTjg, partitions=[PartitionData(partitionIndex=1, errorCode=0, highWatermark=12, lastStableOffset=12, logStartOffset=0, divergingEpoch=EpochEndOffset(epoch=-1, endOffset=-1), currentLeader=LeaderIdAndEpoch(leaderId=-1, leaderEpoch=-1), snapshotId=SnapshotId(endOffset=-1, epoch=-1), abortedTransactions=[], preferredReadReplica=-1, records=MemoryRecords(size=249, buffer=java.nio.HeapByteBuffer[pos=0 lim=249 cap=252]))])])
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 1477165816 with 1 response partition(s)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Fetch READ_COMMITTED at offset 10 for partition resources-1 returned fetch data PartitionData(partitionIndex=1, errorCode=0, highWatermark=12, lastStableOffset=12, logStartOffset=0, divergingEpoch=EpochEndOffset(epoch=-1, endOffset=-1), currentLeader=LeaderIdAndEpoch(leaderId=-1, leaderEpoch=-1), snapshotId=SnapshotId(endOffset=-1, epoch=-1), abortedTransactions=[], preferredReadReplica=-1, records=MemoryRecords(size=249, buffer=java.nio.HeapByteBuffer[pos=0 lim=249 cap=252]))
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-1 at position FetchPosition{offset=12, offsetEpoch=Optional[29], currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=29}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Built incremental fetch (sessionId=1477165816, epoch=3095) for node 2. Added 0 partition(s), altered 1 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(resources-1), toForget=(), toReplace=(), implied=(), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-2, correlationId=3634) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=1477165816, sessionEpoch=3095, topics=[FetchTopic(topic='resources', topicId=dIcm1yNOQS2tA7tmVPbTjg, partitions=[FetchPartition(partition=1, currentLeaderEpoch=29, fetchOffset=12, lastFetchedEpoch=-1, logStartOffset=-1, partitionMaxBytes=1048576)])], forgottenTopicsData=[], rackId='')
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : Received: 1 records
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : Processing [GenericMessage [payload=ResourceRecord{id=86}, headers={kafka_offset=10, kafka_consumer=org.apache.kafka.clients.consumer.KafkaConsumer@61e0e4fa, kafka_timestampType=CREATE_TIME, kafka_receivedPartitionId=1, kafka_receivedMessageKey=86, kafka_receivedTopic=resources, kafka_receivedTimestamp=1668947858875, kafka_acknowledgment=Acknowledgment for resources-1@10, __TypeId__=[B@4e48c7d, kafka_groupId=resource-processor}]]
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  : Processing resource record: ResourceRecord{id=86}
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  : Validating a resource record 'ResourceRecord{id=86}'
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : Retry: count=0
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] INFO  : Converting input data buffer to a file with type 'MP3'
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-1, correlationId=3633): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=421773985, responses=[])
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 421773985 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-3, correlationId=3632): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=570225658, responses=[])
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 570225658 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-0 at position FetchPosition{offset=14, offsetEpoch=Optional[24], currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=28}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-2 at position FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=26}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Built incremental fetch (sessionId=421773985, epoch=3095) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Built incremental fetch (sessionId=570225658, epoch=3094) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-0), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-1, correlationId=3634) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=421773985, sessionEpoch=3095, topics=[], forgottenTopicsData=[], rackId='')
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-2), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-3, correlationId=3633) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=570225658, sessionEpoch=3094, topics=[], forgottenTopicsData=[], rackId='')
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : [5208557f] HTTP GET /resources/86
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : -Dio.netty.hostsFileRefreshInterval: 0
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : -Dio.netty.native.workdir: /var/folders/d6/pnxnxkwx6k78txwskn_k1n280000gn/T (io.netty.tmpdir)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : -Dio.netty.native.deleteLibAfterLoading: true
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : -Dio.netty.native.tryPatchShadedId: true
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-1-C-1] DEBUG : -Dio.netty.native.detectNativeLibraryDuplicates: true
2022-11-20 17:37:39 [kafka-coordinator-heartbeat-thread | resource-processor] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-2, correlationId=3634): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=1477165816, responses=[])
2022-11-20 17:37:39 [kafka-coordinator-heartbeat-thread | resource-processor] DEBUG : [Consumer clientId=consumer-resource-processor-2, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 1477165816 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-3, correlationId=3633): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=570225658, responses=[])
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Received FETCH response from node 2 for request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-1, correlationId=3634): FetchResponseData(throttleTimeMs=0, errorCode=0, sessionId=421773985, responses=[])
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 570225658 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Node 2 sent an incremental fetch response with throttleTimeMs = 0 for session 421773985 with 0 response partition(s), 1 implied partition(s)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-2 at position FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=26}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Added READ_COMMITTED fetch request for partition resources-0 at position FetchPosition{offset=14, offsetEpoch=Optional[24], currentLeader=LeaderAndEpoch{leader=Optional[10.22.157.37:9094 (id: 2 rack: null)], epoch=28}} to node 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Built incremental fetch (sessionId=570225658, epoch=3095) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Built incremental fetch (sessionId=421773985, epoch=3096) for node 2. Added 0 partition(s), altered 0 partition(s), removed 0 partition(s), replaced 0 partition(s) out of 1 partition(s)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-2), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending READ_COMMITTED IncrementalFetchRequest(toSend=(), toForget=(), toReplace=(), implied=(resources-0), canUseTopicIds=True) to broker 10.22.157.37:9094 (id: 2 rack: null)
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-1, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-1, correlationId=3635) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=421773985, sessionEpoch=3096, topics=[], forgottenTopicsData=[], rackId='')
2022-11-20 17:37:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-2-C-1] DEBUG : [Consumer clientId=consumer-resource-processor-3, groupId=resource-processor] Sending FETCH request with header RequestHeader(apiKey=FETCH, apiVersion=13, clientId=consumer-resource-processor-3, correlationId=3634) and timeout 30000 to node 2: FetchRequestData(clusterId=null, replicaId=-1, maxWaitMs=500, minBytes=1, maxBytes=52428800, isolationLevel=1, sessionId=570225658, sessionEpoch=3095, topics=[], forgottenTopicsData=[], rackId='')
